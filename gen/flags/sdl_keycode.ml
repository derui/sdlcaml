type t =
    SDLK_0
  | SDLK_1
  | SDLK_2
  | SDLK_3
  | SDLK_4
  | SDLK_5
  | SDLK_6
  | SDLK_7
  | SDLK_8
  | SDLK_9
  | SDLK_a
  | SDLK_AC_BACK
  | SDLK_AC_BOOKMARKS
  | SDLK_AC_FORWARD
  | SDLK_AC_HOME
  | SDLK_AC_REFRESH
  | SDLK_AC_SEARCH
  | SDLK_AC_STOP
  | SDLK_AGAIN
  | SDLK_ALTERASE
  | SDLK_QUOTE
  | SDLK_APPLICATION
  | SDLK_AUDIOMUTE
  | SDLK_AUDIONEXT
  | SDLK_AUDIOPLAY
  | SDLK_AUDIOPREV
  | SDLK_AUDIOSTOP
  | SDLK_b
  | SDLK_BACKSLASH
  | SDLK_BACKSPACE
  | SDLK_BRIGHTNESSDOWN
  | SDLK_BRIGHTNESSUP
  | SDLK_c
  | SDLK_CALCULATOR
  | SDLK_CANCEL
  | SDLK_CAPSLOCK
  | SDLK_CLEAR
  | SDLK_CLEARAGAIN
  | SDLK_COMMA
  | SDLK_COMPUTER
  | SDLK_COPY
  | SDLK_CRSEL
  | SDLK_CURRENCYSUBUNIT
  | SDLK_CURRENCYUNIT
  | SDLK_CUT
  | SDLK_d
  | SDLK_DECIMALSEPARATOR
  | SDLK_DELETE
  | SDLK_DISPLAYSWITCH
  | SDLK_DOWN
  | SDLK_e
  | SDLK_EJECT
  | SDLK_END
  | SDLK_EQUALS
  | SDLK_ESCAPE
  | SDLK_EXECUTE
  | SDLK_EXSEL
  | SDLK_f
  | SDLK_F1
  | SDLK_F10
  | SDLK_F11
  | SDLK_F12
  | SDLK_F13
  | SDLK_F14
  | SDLK_F15
  | SDLK_F16
  | SDLK_F17
  | SDLK_F18
  | SDLK_F19
  | SDLK_F2
  | SDLK_F20
  | SDLK_F21
  | SDLK_F22
  | SDLK_F23
  | SDLK_F24
  | SDLK_F3
  | SDLK_F4
  | SDLK_F5
  | SDLK_F6
  | SDLK_F7
  | SDLK_F8
  | SDLK_F9
  | SDLK_FIND
  | SDLK_g
  | SDLK_BACKQUOTE
  | SDLK_h
  | SDLK_HELP
  | SDLK_HOME
  | SDLK_i
  | SDLK_INSERT
  | SDLK_j
  | SDLK_k
  | SDLK_KBDILLUMDOWN
  | SDLK_KBDILLUMTOGGLE
  | SDLK_KBDILLUMUP
  | SDLK_KP_0
  | SDLK_KP_00
  | SDLK_KP_000
  | SDLK_KP_1
  | SDLK_KP_2
  | SDLK_KP_3
  | SDLK_KP_4
  | SDLK_KP_5
  | SDLK_KP_6
  | SDLK_KP_7
  | SDLK_KP_8
  | SDLK_KP_9
  | SDLK_KP_A
  | SDLK_KP_AMPERSAND
  | SDLK_KP_AT
  | SDLK_KP_B
  | SDLK_KP_BACKSPACE
  | SDLK_KP_BINARY
  | SDLK_KP_C
  | SDLK_KP_CLEAR
  | SDLK_KP_CLEARENTRY
  | SDLK_KP_COLON
  | SDLK_KP_COMMA
  | SDLK_KP_D
  | SDLK_KP_DBLAMPERSAND
  | SDLK_KP_DBLVERTICALBAR
  | SDLK_KP_DECIMAL
  | SDLK_KP_DIVIDE
  | SDLK_KP_E
  | SDLK_KP_ENTER
  | SDLK_KP_EQUALS
  | SDLK_KP_EQUALSAS400
  | SDLK_KP_EXCLAM
  | SDLK_KP_F
  | SDLK_KP_GREATER
  | SDLK_KP_HASH
  | SDLK_KP_HEXADECIMAL
  | SDLK_KP_LEFTBRACE
  | SDLK_KP_LEFTPAREN
  | SDLK_KP_LESS
  | SDLK_KP_MEMADD
  | SDLK_KP_MEMCLEAR
  | SDLK_KP_MEMDIVIDE
  | SDLK_KP_MEMMULTIPLY
  | SDLK_KP_MEMRECALL
  | SDLK_KP_MEMSTORE
  | SDLK_KP_MEMSUBTRACT
  | SDLK_KP_MINUS
  | SDLK_KP_MULTIPLY
  | SDLK_KP_OCTAL
  | SDLK_KP_PERCENT
  | SDLK_KP_PERIOD
  | SDLK_KP_PLUS
  | SDLK_KP_PLUSMINUS
  | SDLK_KP_POWER
  | SDLK_KP_RIGHTBRACE
  | SDLK_KP_RIGHTPAREN
  | SDLK_KP_SPACE
  | SDLK_KP_TAB
  | SDLK_KP_VERTICALBAR
  | SDLK_KP_XOR
  | SDLK_l
  | SDLK_LALT
  | SDLK_LCTRL
  | SDLK_LEFT
  | SDLK_LEFTBRACKET
  | SDLK_LGUI
  | SDLK_LSHIFT
  | SDLK_m
  | SDLK_MAIL
  | SDLK_MEDIASELECT
  | SDLK_MENU
  | SDLK_MINUS
  | SDLK_MODE
  | SDLK_MUTE
  | SDLK_n
  | SDLK_NUMLOCKCLEAR
  | SDLK_o
  | SDLK_OPER
  | SDLK_OUT
  | SDLK_p
  | SDLK_PAGEDOWN
  | SDLK_PAGEUP
  | SDLK_PASTE
  | SDLK_PAUSE
  | SDLK_PERIOD
  | SDLK_POWER
  | SDLK_PRINTSCREEN
  | SDLK_PRIOR
  | SDLK_q
  | SDLK_r
  | SDLK_RALT
  | SDLK_RCTRL
  | SDLK_RETURN
  | SDLK_RETURN2
  | SDLK_RGUI
  | SDLK_RIGHT
  | SDLK_RIGHTBRACKET
  | SDLK_RSHIFT
  | SDLK_s
  | SDLK_SCROLLLOCK
  | SDLK_SELECT
  | SDLK_SEMICOLON
  | SDLK_SEPARATOR
  | SDLK_SLASH
  | SDLK_SLEEP
  | SDLK_SPACE
  | SDLK_STOP
  | SDLK_SYSREQ
  | SDLK_t
  | SDLK_TAB
  | SDLK_THOUSANDSSEPARATOR
  | SDLK_u
  | SDLK_UNDO
  | SDLK_UP
  | SDLK_v
  | SDLK_VOLUMEDOWN
  | SDLK_VOLUMEUP
  | SDLK_w
  | SDLK_WWW
  | SDLK_x
  | SDLK_y
  | SDLK_z
  | SDLK_AMPERSAND
  | SDLK_ASTERISK
  | SDLK_AT
  | SDLK_CARET
  | SDLK_COLON
  | SDLK_DOLLAR
  | SDLK_EXCLAIM
  | SDLK_GREATER
  | SDLK_HASH
  | SDLK_LEFTPAREN
  | SDLK_LESS
  | SDLK_PERCENT
  | SDLK_PLUS
  | SDLK_QUESTION
  | SDLK_QUOTEDBL
  | SDLK_RIGHTPAREN
  | SDLK_UNDERSCORE
  | SDLK_UNKNOWN

let scan_mask = 1 lsl 30
let scancode_to_int scan = (Sdl_scancode.to_int scan) lor scan_mask
let unmask_key_to_scan c = (lnot scan_mask) land c

let to_int = function
  | SDLK_UNKNOWN -> 0
  |  SDLK_RETURN  -> int_of_char '\r'
  |  SDLK_ESCAPE  -> int_of_char '\033'
  |  SDLK_BACKSPACE  -> int_of_char '\b'
  |  SDLK_TAB  -> int_of_char '\t'
  |  SDLK_SPACE  -> int_of_char ' '
  |  SDLK_EXCLAIM  -> int_of_char '!'
  |  SDLK_QUOTEDBL  -> int_of_char '"'
  |  SDLK_HASH  -> int_of_char '#'
  |  SDLK_PERCENT  -> int_of_char '%'
  |  SDLK_DOLLAR  -> int_of_char '$'
  |  SDLK_AMPERSAND  -> int_of_char '&'
  |  SDLK_QUOTE  -> int_of_char '\''
  |  SDLK_LEFTPAREN  -> int_of_char '('
  |  SDLK_RIGHTPAREN  -> int_of_char ')'
  |  SDLK_ASTERISK  -> int_of_char '*'
  |  SDLK_PLUS  -> int_of_char '+'
  |  SDLK_COMMA  -> int_of_char ','
  |  SDLK_MINUS  -> int_of_char '-'
  |  SDLK_PERIOD  -> int_of_char '.'
  |  SDLK_SLASH  -> int_of_char '/'
  |  SDLK_0  -> int_of_char '0'
  |  SDLK_1  -> int_of_char '1'
  |  SDLK_2  -> int_of_char '2'
  |  SDLK_3  -> int_of_char '3'
  |  SDLK_4  -> int_of_char '4'
  |  SDLK_5  -> int_of_char '5'
  |  SDLK_6  -> int_of_char '6'
  |  SDLK_7  -> int_of_char '7'
  |  SDLK_8  -> int_of_char '8'
  |  SDLK_9  -> int_of_char '9'
  |  SDLK_COLON  -> int_of_char ':'
  |  SDLK_SEMICOLON  -> int_of_char ';'
  |  SDLK_LESS  -> int_of_char '<'
  |  SDLK_EQUALS -> int_of_char '='
  |  SDLK_GREATER  -> int_of_char '>'
  |  SDLK_QUESTION  -> int_of_char '?'
  |  SDLK_AT  -> int_of_char '@'
  |  SDLK_LEFTBRACKET  -> int_of_char '['
  |  SDLK_BACKSLASH  -> int_of_char '\\'
  |  SDLK_RIGHTBRACKET  -> int_of_char ']'
  |  SDLK_CARET  -> int_of_char '^'
  |  SDLK_UNDERSCORE  -> int_of_char '_'
  |  SDLK_BACKQUOTE  -> int_of_char '`'
  |  SDLK_a  -> int_of_char 'a'
  |  SDLK_b  -> int_of_char 'b'
  |  SDLK_c  -> int_of_char 'c'
  |  SDLK_d  -> int_of_char 'd'
  |  SDLK_e  -> int_of_char 'e'
  |  SDLK_f  -> int_of_char 'f'
  |  SDLK_g  -> int_of_char 'g'
  |  SDLK_h  -> int_of_char 'h'
  |  SDLK_i  -> int_of_char 'i'
  |  SDLK_j  -> int_of_char 'j'
  |  SDLK_k  -> int_of_char 'k'
  |  SDLK_l  -> int_of_char 'l'
  |  SDLK_m  -> int_of_char 'm'
  |  SDLK_n  -> int_of_char 'n'
  |  SDLK_o  -> int_of_char 'o'
  |  SDLK_p  -> int_of_char 'p'
  |  SDLK_q  -> int_of_char 'q'
  |  SDLK_r  -> int_of_char 'r'
  |  SDLK_s  -> int_of_char 's'
  |  SDLK_t  -> int_of_char 't'
  |  SDLK_u  -> int_of_char 'u'
  |  SDLK_v  -> int_of_char 'v'
  |  SDLK_w  -> int_of_char 'w'
  |  SDLK_x  -> int_of_char 'x'
  |  SDLK_y  -> int_of_char 'y'
  |  SDLK_z  -> int_of_char 'z'
  | SDLK_DELETE -> int_of_char '\177'
  |     SDLK_CAPSLOCK  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CAPSLOCK
  |     SDLK_F1  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F1
  |     SDLK_F2  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F2
  |     SDLK_F3  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F3
  |     SDLK_F4  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F4
  |     SDLK_F5  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F5
  |     SDLK_F6  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F6
  |     SDLK_F7  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F7
  |     SDLK_F8  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F8
  |     SDLK_F9  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F9
  |     SDLK_F10  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F10
  |     SDLK_F11  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F11
  |     SDLK_F12  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F12
  |     SDLK_PRINTSCREEN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_PRINTSCREEN
  |     SDLK_SCROLLLOCK  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_SCROLLLOCK
  |     SDLK_PAUSE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_PAUSE
  |     SDLK_INSERT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_INSERT
  |     SDLK_HOME  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_HOME
  |     SDLK_PAGEUP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_PAGEUP
  |     SDLK_END  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_END
  |     SDLK_PAGEDOWN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_PAGEDOWN
  |     SDLK_RIGHT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_RIGHT
  |     SDLK_LEFT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_LEFT
  |     SDLK_DOWN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_DOWN
  |     SDLK_UP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_UP
  |     SDLK_NUMLOCKCLEAR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_NUMLOCKCLEAR
  |     SDLK_KP_DIVIDE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_DIVIDE
  |     SDLK_KP_MULTIPLY  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MULTIPLY
  |     SDLK_KP_MINUS  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MINUS
  |     SDLK_KP_PLUS  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_PLUS
  |     SDLK_KP_ENTER  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_ENTER
  |     SDLK_KP_1  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_1
  |     SDLK_KP_2  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_2
  |     SDLK_KP_3  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_3
  |     SDLK_KP_4  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_4
  |     SDLK_KP_5  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_5
  |     SDLK_KP_6  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_6
  |     SDLK_KP_7  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_7
  |     SDLK_KP_8  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_8
  |     SDLK_KP_9  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_9
  |     SDLK_KP_0  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_0
  |     SDLK_KP_PERIOD  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_PERIOD
  |     SDLK_APPLICATION  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_APPLICATION
  |     SDLK_POWER  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_POWER
  |     SDLK_KP_EQUALS  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_EQUALS
  |     SDLK_F13  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F13
  |     SDLK_F14  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F14
  |     SDLK_F15  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F15
  |     SDLK_F16  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F16
  |     SDLK_F17  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F17
  |     SDLK_F18  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F18
  |     SDLK_F19  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F19
  |     SDLK_F20  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F20
  |     SDLK_F21  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F21
  |     SDLK_F22  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F22
  |     SDLK_F23  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F23
  |     SDLK_F24  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_F24
  |     SDLK_EXECUTE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_EXECUTE
  |     SDLK_HELP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_HELP
  |     SDLK_MENU  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_MENU
  |     SDLK_SELECT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_SELECT
  |     SDLK_STOP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_STOP
  |     SDLK_AGAIN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AGAIN
  |     SDLK_UNDO  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_UNDO
  |     SDLK_CUT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CUT
  |     SDLK_COPY  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_COPY
  |     SDLK_PASTE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_PASTE
  |     SDLK_FIND  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_FIND
  |     SDLK_MUTE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_MUTE
  |     SDLK_VOLUMEUP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_VOLUMEUP
  |     SDLK_VOLUMEDOWN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_VOLUMEDOWN
  |     SDLK_KP_COMMA  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_COMMA
  |     SDLK_KP_EQUALSAS400  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_EQUALSAS400
  |     SDLK_ALTERASE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_ALTERASE
  |     SDLK_SYSREQ  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_SYSREQ
  |     SDLK_CANCEL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CANCEL
  |     SDLK_CLEAR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CLEAR
  |     SDLK_PRIOR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_PRIOR
  |     SDLK_RETURN2  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_RETURN2
  |     SDLK_SEPARATOR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_SEPARATOR
  |     SDLK_OUT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_OUT
  |     SDLK_OPER  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_OPER
  |     SDLK_CLEARAGAIN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CLEARAGAIN
  |     SDLK_CRSEL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CRSEL
  |     SDLK_EXSEL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_EXSEL
  |     SDLK_KP_00  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_00
  |     SDLK_KP_000  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_000
  |     SDLK_THOUSANDSSEPARATOR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_THOUSANDSSEPARATOR
  |     SDLK_DECIMALSEPARATOR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_DECIMALSEPARATOR
  |     SDLK_CURRENCYUNIT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CURRENCYUNIT
  |     SDLK_CURRENCYSUBUNIT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CURRENCYSUBUNIT
  |     SDLK_KP_LEFTPAREN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_LEFTPAREN
  |     SDLK_KP_RIGHTPAREN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_RIGHTPAREN
  |     SDLK_KP_LEFTBRACE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_LEFTBRACE
  |     SDLK_KP_RIGHTBRACE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_RIGHTBRACE
  |     SDLK_KP_TAB  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_TAB
  |     SDLK_KP_BACKSPACE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_BACKSPACE
  |     SDLK_KP_A  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_A
  |     SDLK_KP_B  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_B
  |     SDLK_KP_C  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_C
  |     SDLK_KP_D  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_D
  |     SDLK_KP_E  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_E
  |     SDLK_KP_F  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_F
  |     SDLK_KP_XOR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_XOR
  |     SDLK_KP_POWER  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_POWER
  |     SDLK_KP_PERCENT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_PERCENT
  |     SDLK_KP_LESS  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_LESS
  |     SDLK_KP_GREATER  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_GREATER
  |     SDLK_KP_AMPERSAND  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_AMPERSAND
  |     SDLK_KP_DBLAMPERSAND  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_DBLAMPERSAND
  |     SDLK_KP_VERTICALBAR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_VERTICALBAR
  |     SDLK_KP_DBLVERTICALBAR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_DBLVERTICALBAR
  |     SDLK_KP_COLON  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_COLON
  |     SDLK_KP_HASH  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_HASH
  |     SDLK_KP_SPACE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_SPACE
  |     SDLK_KP_AT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_AT
  |     SDLK_KP_EXCLAM  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_EXCLAM
  |     SDLK_KP_MEMSTORE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMSTORE
  |     SDLK_KP_MEMRECALL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMRECALL
  |     SDLK_KP_MEMCLEAR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMCLEAR
  |     SDLK_KP_MEMADD  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMADD
  |     SDLK_KP_MEMSUBTRACT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMSUBTRACT
  |     SDLK_KP_MEMMULTIPLY  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMMULTIPLY
  |     SDLK_KP_MEMDIVIDE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_MEMDIVIDE
  |     SDLK_KP_PLUSMINUS  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_PLUSMINUS
  |     SDLK_KP_CLEAR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_CLEAR
  |     SDLK_KP_CLEARENTRY  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_CLEARENTRY
  |     SDLK_KP_BINARY  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_BINARY
  |     SDLK_KP_OCTAL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_OCTAL
  |     SDLK_KP_DECIMAL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_DECIMAL
  |     SDLK_KP_HEXADECIMAL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KP_HEXADECIMAL
  |     SDLK_LCTRL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_LCTRL
  |     SDLK_LSHIFT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_LSHIFT
  |     SDLK_LALT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_LALT
  |     SDLK_LGUI  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_LGUI
  |     SDLK_RCTRL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_RCTRL
  |     SDLK_RSHIFT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_RSHIFT
  |     SDLK_RALT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_RALT
  |     SDLK_RGUI  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_RGUI
  |     SDLK_MODE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_MODE
  |     SDLK_AUDIONEXT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AUDIONEXT
  |     SDLK_AUDIOPREV  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AUDIOPREV
  |     SDLK_AUDIOSTOP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AUDIOSTOP
  |     SDLK_AUDIOPLAY  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AUDIOPLAY
  |     SDLK_AUDIOMUTE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AUDIOMUTE
  |     SDLK_MEDIASELECT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_MEDIASELECT
  |     SDLK_WWW  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_WWW
  |     SDLK_MAIL  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_MAIL
  |     SDLK_CALCULATOR  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_CALCULATOR
  |     SDLK_COMPUTER  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_COMPUTER
  |     SDLK_AC_SEARCH  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_SEARCH
  |     SDLK_AC_HOME  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_HOME
  |     SDLK_AC_BACK  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_BACK
  |     SDLK_AC_FORWARD  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_FORWARD
  |     SDLK_AC_STOP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_STOP
  |     SDLK_AC_REFRESH  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_REFRESH
  |     SDLK_AC_BOOKMARKS  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_AC_BOOKMARKS
  |     SDLK_BRIGHTNESSDOWN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_BRIGHTNESSDOWN
  |     SDLK_BRIGHTNESSUP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_BRIGHTNESSUP
  |     SDLK_DISPLAYSWITCH  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_DISPLAYSWITCH
  |     SDLK_KBDILLUMTOGGLE  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KBDILLUMTOGGLE
  |     SDLK_KBDILLUMDOWN  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KBDILLUMDOWN
  |     SDLK_KBDILLUMUP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_KBDILLUMUP
  |     SDLK_EJECT  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_EJECT
  |     SDLK_SLEEP  -> scancode_to_int Sdl_scancode.SDL_SCANCODE_SLEEP

let scan_to_key = function
  | Sdl_scancode.SDL_SCANCODE_CAPSLOCK -> SDLK_CAPSLOCK
  | Sdl_scancode.SDL_SCANCODE_F1 -> SDLK_F1
  | Sdl_scancode.SDL_SCANCODE_F2 -> SDLK_F2
  | Sdl_scancode.SDL_SCANCODE_F3 -> SDLK_F3
  | Sdl_scancode.SDL_SCANCODE_F4 -> SDLK_F4
  | Sdl_scancode.SDL_SCANCODE_F5 -> SDLK_F5
  | Sdl_scancode.SDL_SCANCODE_F6 -> SDLK_F6
  | Sdl_scancode.SDL_SCANCODE_F7 -> SDLK_F7
  | Sdl_scancode.SDL_SCANCODE_F8 -> SDLK_F8
  | Sdl_scancode.SDL_SCANCODE_F9 -> SDLK_F9
  | Sdl_scancode.SDL_SCANCODE_F10 -> SDLK_F10
  | Sdl_scancode.SDL_SCANCODE_F11 -> SDLK_F11
  | Sdl_scancode.SDL_SCANCODE_F12 -> SDLK_F12
  | Sdl_scancode.SDL_SCANCODE_PRINTSCREEN -> SDLK_PRINTSCREEN
  | Sdl_scancode.SDL_SCANCODE_SCROLLLOCK -> SDLK_SCROLLLOCK
  | Sdl_scancode.SDL_SCANCODE_PAUSE -> SDLK_PAUSE
  | Sdl_scancode.SDL_SCANCODE_INSERT -> SDLK_INSERT
  | Sdl_scancode.SDL_SCANCODE_HOME -> SDLK_HOME
  | Sdl_scancode.SDL_SCANCODE_PAGEUP -> SDLK_PAGEUP
  | Sdl_scancode.SDL_SCANCODE_END -> SDLK_END
  | Sdl_scancode.SDL_SCANCODE_PAGEDOWN -> SDLK_PAGEDOWN
  | Sdl_scancode.SDL_SCANCODE_RIGHT -> SDLK_RIGHT
  | Sdl_scancode.SDL_SCANCODE_LEFT -> SDLK_LEFT
  | Sdl_scancode.SDL_SCANCODE_DOWN -> SDLK_DOWN
  | Sdl_scancode.SDL_SCANCODE_UP -> SDLK_UP
  | Sdl_scancode.SDL_SCANCODE_NUMLOCKCLEAR -> SDLK_NUMLOCKCLEAR
  | Sdl_scancode.SDL_SCANCODE_KP_DIVIDE -> SDLK_KP_DIVIDE
  | Sdl_scancode.SDL_SCANCODE_KP_MULTIPLY -> SDLK_KP_MULTIPLY
  | Sdl_scancode.SDL_SCANCODE_KP_MINUS -> SDLK_KP_MINUS
  | Sdl_scancode.SDL_SCANCODE_KP_PLUS -> SDLK_KP_PLUS
  | Sdl_scancode.SDL_SCANCODE_KP_ENTER -> SDLK_KP_ENTER
  | Sdl_scancode.SDL_SCANCODE_KP_1 -> SDLK_KP_1
  | Sdl_scancode.SDL_SCANCODE_KP_2 -> SDLK_KP_2
  | Sdl_scancode.SDL_SCANCODE_KP_3 -> SDLK_KP_3
  | Sdl_scancode.SDL_SCANCODE_KP_4 -> SDLK_KP_4
  | Sdl_scancode.SDL_SCANCODE_KP_5 -> SDLK_KP_5
  | Sdl_scancode.SDL_SCANCODE_KP_6 -> SDLK_KP_6
  | Sdl_scancode.SDL_SCANCODE_KP_7 -> SDLK_KP_7
  | Sdl_scancode.SDL_SCANCODE_KP_8 -> SDLK_KP_8
  | Sdl_scancode.SDL_SCANCODE_KP_9 -> SDLK_KP_9
  | Sdl_scancode.SDL_SCANCODE_KP_0 -> SDLK_KP_0
  | Sdl_scancode.SDL_SCANCODE_KP_PERIOD -> SDLK_KP_PERIOD
  | Sdl_scancode.SDL_SCANCODE_APPLICATION -> SDLK_APPLICATION
  | Sdl_scancode.SDL_SCANCODE_POWER -> SDLK_POWER
  | Sdl_scancode.SDL_SCANCODE_KP_EQUALS -> SDLK_KP_EQUALS
  | Sdl_scancode.SDL_SCANCODE_F13 -> SDLK_F13
  | Sdl_scancode.SDL_SCANCODE_F14 -> SDLK_F14
  | Sdl_scancode.SDL_SCANCODE_F15 -> SDLK_F15
  | Sdl_scancode.SDL_SCANCODE_F16 -> SDLK_F16
  | Sdl_scancode.SDL_SCANCODE_F17 -> SDLK_F17
  | Sdl_scancode.SDL_SCANCODE_F18 -> SDLK_F18
  | Sdl_scancode.SDL_SCANCODE_F19 -> SDLK_F19
  | Sdl_scancode.SDL_SCANCODE_F20 -> SDLK_F20
  | Sdl_scancode.SDL_SCANCODE_F21 -> SDLK_F21
  | Sdl_scancode.SDL_SCANCODE_F22 -> SDLK_F22
  | Sdl_scancode.SDL_SCANCODE_F23 -> SDLK_F23
  | Sdl_scancode.SDL_SCANCODE_F24 -> SDLK_F24
  | Sdl_scancode.SDL_SCANCODE_EXECUTE -> SDLK_EXECUTE
  | Sdl_scancode.SDL_SCANCODE_HELP -> SDLK_HELP
  | Sdl_scancode.SDL_SCANCODE_MENU -> SDLK_MENU
  | Sdl_scancode.SDL_SCANCODE_SELECT -> SDLK_SELECT
  | Sdl_scancode.SDL_SCANCODE_STOP -> SDLK_STOP
  | Sdl_scancode.SDL_SCANCODE_AGAIN -> SDLK_AGAIN
  | Sdl_scancode.SDL_SCANCODE_UNDO -> SDLK_UNDO
  | Sdl_scancode.SDL_SCANCODE_CUT -> SDLK_CUT
  | Sdl_scancode.SDL_SCANCODE_COPY -> SDLK_COPY
  | Sdl_scancode.SDL_SCANCODE_PASTE -> SDLK_PASTE
  | Sdl_scancode.SDL_SCANCODE_FIND -> SDLK_FIND
  | Sdl_scancode.SDL_SCANCODE_MUTE -> SDLK_MUTE
  | Sdl_scancode.SDL_SCANCODE_VOLUMEUP -> SDLK_VOLUMEUP
  | Sdl_scancode.SDL_SCANCODE_VOLUMEDOWN -> SDLK_VOLUMEDOWN
  | Sdl_scancode.SDL_SCANCODE_KP_COMMA -> SDLK_KP_COMMA
  | Sdl_scancode.SDL_SCANCODE_KP_EQUALSAS400 -> SDLK_KP_EQUALSAS400
  | Sdl_scancode.SDL_SCANCODE_ALTERASE -> SDLK_ALTERASE
  | Sdl_scancode.SDL_SCANCODE_SYSREQ -> SDLK_SYSREQ
  | Sdl_scancode.SDL_SCANCODE_CANCEL -> SDLK_CANCEL
  | Sdl_scancode.SDL_SCANCODE_CLEAR -> SDLK_CLEAR
  | Sdl_scancode.SDL_SCANCODE_PRIOR -> SDLK_PRIOR
  | Sdl_scancode.SDL_SCANCODE_RETURN2 -> SDLK_RETURN2
  | Sdl_scancode.SDL_SCANCODE_SEPARATOR -> SDLK_SEPARATOR
  | Sdl_scancode.SDL_SCANCODE_OUT -> SDLK_OUT
  | Sdl_scancode.SDL_SCANCODE_OPER -> SDLK_OPER
  | Sdl_scancode.SDL_SCANCODE_CLEARAGAIN -> SDLK_CLEARAGAIN
  | Sdl_scancode.SDL_SCANCODE_CRSEL -> SDLK_CRSEL
  | Sdl_scancode.SDL_SCANCODE_EXSEL -> SDLK_EXSEL
  | Sdl_scancode.SDL_SCANCODE_KP_00 -> SDLK_KP_00
  | Sdl_scancode.SDL_SCANCODE_KP_000 -> SDLK_KP_000
  | Sdl_scancode.SDL_SCANCODE_THOUSANDSSEPARATOR -> SDLK_THOUSANDSSEPARATOR
  | Sdl_scancode.SDL_SCANCODE_DECIMALSEPARATOR -> SDLK_DECIMALSEPARATOR
  | Sdl_scancode.SDL_SCANCODE_CURRENCYUNIT -> SDLK_CURRENCYUNIT
  | Sdl_scancode.SDL_SCANCODE_CURRENCYSUBUNIT -> SDLK_CURRENCYSUBUNIT
  | Sdl_scancode.SDL_SCANCODE_KP_LEFTPAREN -> SDLK_KP_LEFTPAREN
  | Sdl_scancode.SDL_SCANCODE_KP_RIGHTPAREN -> SDLK_KP_RIGHTPAREN
  | Sdl_scancode.SDL_SCANCODE_KP_LEFTBRACE -> SDLK_KP_LEFTBRACE
  | Sdl_scancode.SDL_SCANCODE_KP_RIGHTBRACE -> SDLK_KP_RIGHTBRACE
  | Sdl_scancode.SDL_SCANCODE_KP_TAB -> SDLK_KP_TAB
  | Sdl_scancode.SDL_SCANCODE_KP_BACKSPACE -> SDLK_KP_BACKSPACE
  | Sdl_scancode.SDL_SCANCODE_KP_A -> SDLK_KP_A
  | Sdl_scancode.SDL_SCANCODE_KP_B -> SDLK_KP_B
  | Sdl_scancode.SDL_SCANCODE_KP_C -> SDLK_KP_C
  | Sdl_scancode.SDL_SCANCODE_KP_D -> SDLK_KP_D
  | Sdl_scancode.SDL_SCANCODE_KP_E -> SDLK_KP_E
  | Sdl_scancode.SDL_SCANCODE_KP_F -> SDLK_KP_F
  | Sdl_scancode.SDL_SCANCODE_KP_XOR -> SDLK_KP_XOR
  | Sdl_scancode.SDL_SCANCODE_KP_POWER -> SDLK_KP_POWER
  | Sdl_scancode.SDL_SCANCODE_KP_PERCENT -> SDLK_KP_PERCENT
  | Sdl_scancode.SDL_SCANCODE_KP_LESS -> SDLK_KP_LESS
  | Sdl_scancode.SDL_SCANCODE_KP_GREATER -> SDLK_KP_GREATER
  | Sdl_scancode.SDL_SCANCODE_KP_AMPERSAND -> SDLK_KP_AMPERSAND
  | Sdl_scancode.SDL_SCANCODE_KP_DBLAMPERSAND -> SDLK_KP_DBLAMPERSAND
  | Sdl_scancode.SDL_SCANCODE_KP_VERTICALBAR -> SDLK_KP_VERTICALBAR
  | Sdl_scancode.SDL_SCANCODE_KP_DBLVERTICALBAR -> SDLK_KP_DBLVERTICALBAR
  | Sdl_scancode.SDL_SCANCODE_KP_COLON -> SDLK_KP_COLON
  | Sdl_scancode.SDL_SCANCODE_KP_HASH -> SDLK_KP_HASH
  | Sdl_scancode.SDL_SCANCODE_KP_SPACE -> SDLK_KP_SPACE
  | Sdl_scancode.SDL_SCANCODE_KP_AT -> SDLK_KP_AT
  | Sdl_scancode.SDL_SCANCODE_KP_EXCLAM -> SDLK_KP_EXCLAM
  | Sdl_scancode.SDL_SCANCODE_KP_MEMSTORE -> SDLK_KP_MEMSTORE
  | Sdl_scancode.SDL_SCANCODE_KP_MEMRECALL -> SDLK_KP_MEMRECALL
  | Sdl_scancode.SDL_SCANCODE_KP_MEMCLEAR -> SDLK_KP_MEMCLEAR
  | Sdl_scancode.SDL_SCANCODE_KP_MEMADD -> SDLK_KP_MEMADD
  | Sdl_scancode.SDL_SCANCODE_KP_MEMSUBTRACT -> SDLK_KP_MEMSUBTRACT
  | Sdl_scancode.SDL_SCANCODE_KP_MEMMULTIPLY -> SDLK_KP_MEMMULTIPLY
  | Sdl_scancode.SDL_SCANCODE_KP_MEMDIVIDE -> SDLK_KP_MEMDIVIDE
  | Sdl_scancode.SDL_SCANCODE_KP_PLUSMINUS -> SDLK_KP_PLUSMINUS
  | Sdl_scancode.SDL_SCANCODE_KP_CLEAR -> SDLK_KP_CLEAR
  | Sdl_scancode.SDL_SCANCODE_KP_CLEARENTRY -> SDLK_KP_CLEARENTRY
  | Sdl_scancode.SDL_SCANCODE_KP_BINARY -> SDLK_KP_BINARY
  | Sdl_scancode.SDL_SCANCODE_KP_OCTAL -> SDLK_KP_OCTAL
  | Sdl_scancode.SDL_SCANCODE_KP_DECIMAL -> SDLK_KP_DECIMAL
  | Sdl_scancode.SDL_SCANCODE_KP_HEXADECIMAL -> SDLK_KP_HEXADECIMAL
  | Sdl_scancode.SDL_SCANCODE_LCTRL -> SDLK_LCTRL
  | Sdl_scancode.SDL_SCANCODE_LSHIFT -> SDLK_LSHIFT
  | Sdl_scancode.SDL_SCANCODE_LALT -> SDLK_LALT
  | Sdl_scancode.SDL_SCANCODE_LGUI -> SDLK_LGUI
  | Sdl_scancode.SDL_SCANCODE_RCTRL -> SDLK_RCTRL
  | Sdl_scancode.SDL_SCANCODE_RSHIFT -> SDLK_RSHIFT
  | Sdl_scancode.SDL_SCANCODE_RALT -> SDLK_RALT
  | Sdl_scancode.SDL_SCANCODE_RGUI -> SDLK_RGUI
  | Sdl_scancode.SDL_SCANCODE_MODE -> SDLK_MODE
  | Sdl_scancode.SDL_SCANCODE_AUDIONEXT -> SDLK_AUDIONEXT
  | Sdl_scancode.SDL_SCANCODE_AUDIOPREV -> SDLK_AUDIOPREV
  | Sdl_scancode.SDL_SCANCODE_AUDIOSTOP -> SDLK_AUDIOSTOP
  | Sdl_scancode.SDL_SCANCODE_AUDIOPLAY -> SDLK_AUDIOPLAY
  | Sdl_scancode.SDL_SCANCODE_AUDIOMUTE -> SDLK_AUDIOMUTE
  | Sdl_scancode.SDL_SCANCODE_MEDIASELECT -> SDLK_MEDIASELECT
  | Sdl_scancode.SDL_SCANCODE_WWW -> SDLK_WWW
  | Sdl_scancode.SDL_SCANCODE_MAIL -> SDLK_MAIL
  | Sdl_scancode.SDL_SCANCODE_CALCULATOR -> SDLK_CALCULATOR
  | Sdl_scancode.SDL_SCANCODE_COMPUTER -> SDLK_COMPUTER
  | Sdl_scancode.SDL_SCANCODE_AC_SEARCH -> SDLK_AC_SEARCH
  | Sdl_scancode.SDL_SCANCODE_AC_HOME -> SDLK_AC_HOME
  | Sdl_scancode.SDL_SCANCODE_AC_BACK -> SDLK_AC_BACK
  | Sdl_scancode.SDL_SCANCODE_AC_FORWARD -> SDLK_AC_FORWARD
  | Sdl_scancode.SDL_SCANCODE_AC_STOP -> SDLK_AC_STOP
  | Sdl_scancode.SDL_SCANCODE_AC_REFRESH -> SDLK_AC_REFRESH
  | Sdl_scancode.SDL_SCANCODE_AC_BOOKMARKS -> SDLK_AC_BOOKMARKS
  | Sdl_scancode.SDL_SCANCODE_BRIGHTNESSDOWN -> SDLK_BRIGHTNESSDOWN
  | Sdl_scancode.SDL_SCANCODE_BRIGHTNESSUP -> SDLK_BRIGHTNESSUP
  | Sdl_scancode.SDL_SCANCODE_DISPLAYSWITCH -> SDLK_DISPLAYSWITCH
  | Sdl_scancode.SDL_SCANCODE_KBDILLUMTOGGLE -> SDLK_KBDILLUMTOGGLE
  | Sdl_scancode.SDL_SCANCODE_KBDILLUMDOWN -> SDLK_KBDILLUMDOWN
  | Sdl_scancode.SDL_SCANCODE_KBDILLUMUP -> SDLK_KBDILLUMUP
  | Sdl_scancode.SDL_SCANCODE_EJECT -> SDLK_EJECT
  | Sdl_scancode.SDL_SCANCODE_SLEEP -> SDLK_SLEEP
  | _ -> SDLK_UNKNOWN

let of_int c =
  match char_of_int c with
  | '\r' -> SDLK_RETURN
  | '\027' -> SDLK_ESCAPE
  | '\b' -> SDLK_BACKSPACE
  | '\t' -> SDLK_TAB
  | ' ' -> SDLK_SPACE
  | '!' -> SDLK_EXCLAIM
  | '"' -> SDLK_QUOTEDBL
  | '#' -> SDLK_HASH
  | '%' -> SDLK_PERCENT
  | '$' -> SDLK_DOLLAR
  | '&' -> SDLK_AMPERSAND
  | '\'' -> SDLK_QUOTE
  | '(' -> SDLK_LEFTPAREN
  | ')' -> SDLK_RIGHTPAREN
  | '*' -> SDLK_ASTERISK
  | '+' -> SDLK_PLUS
  | ',' -> SDLK_COMMA
  | '-' -> SDLK_MINUS
  | '.' -> SDLK_PERIOD
  | '/' -> SDLK_SLASH
  | '0' -> SDLK_0
  | '1' -> SDLK_1
  | '2' -> SDLK_2
  | '3' -> SDLK_3
  | '4' -> SDLK_4
  | '5' -> SDLK_5
  | '6' -> SDLK_6
  | '7' -> SDLK_7
  | '8' -> SDLK_8
  | '9' -> SDLK_9
  | ':' -> SDLK_COLON
  | ';' -> SDLK_SEMICOLON
  | '<' -> SDLK_LESS
  | '=' -> SDLK_EQUALS
  | '>' -> SDLK_GREATER
  | '?' -> SDLK_QUESTION
  | '@' -> SDLK_AT
  | '[' -> SDLK_LEFTBRACKET
  | '\\' -> SDLK_BACKSLASH
  | ']' -> SDLK_RIGHTBRACKET
  | '^' -> SDLK_CARET
  | '_' -> SDLK_UNDERSCORE
  | '`' -> SDLK_BACKQUOTE
  | 'a' -> SDLK_a
  | 'b' -> SDLK_b
  | 'c' -> SDLK_c
  | 'd' -> SDLK_d
  | 'e' -> SDLK_e
  | 'f' -> SDLK_f
  | 'g' -> SDLK_g
  | 'h' -> SDLK_h
  | 'i' -> SDLK_i
  | 'j' -> SDLK_j
  | 'k' -> SDLK_k
  | 'l' -> SDLK_l
  | 'm' -> SDLK_m
  | 'n' -> SDLK_n
  | 'o' -> SDLK_o
  | 'p' -> SDLK_p
  | 'q' -> SDLK_q
  | 'r' -> SDLK_r
  | 's' -> SDLK_s
  | 't' -> SDLK_t
  | 'u' -> SDLK_u
  | 'v' -> SDLK_v
  | 'w' -> SDLK_w
  | 'x' -> SDLK_x
  | 'y' -> SDLK_y
  | 'z' -> SDLK_z
  | '\177' -> SDLK_DELETE
  | _ -> let code = unmask_key_to_scan c in
    scan_to_key (Sdl_scancode.of_int code)
